{% extends "base.html" %}

{% block titulo %}
    Pagina Inicio
{% endblock %}
{% block css_maestro%}
    <style>
        .ml10 {
            margin-left: 10px;
        }
    </style>
{% endblock %}

{% block contenido_titulo %}
    Pagina Principal
{% endblock %}
{% block contenido_sub_titulo %}
    <p>Bienvenido</p>
{% endblock %}

{% block contenido %}
{% if perms.personas.add_persona %}
    Agregar
{% endif %}
{% if perms.personas.change_persona %}
    Editar
{% endif %}

{% if perms.personas.delete_persona %}
    eliminar
{% endif %}
 <div id="toolbar">
    <div class="form-inline" role="form">
        <div class="form-group">
          <button id="idNuevaPersona" class="btn btn-primary icon-btn" type="button">
              <i class="fa fa-fw fa-lg fa-check-circle" ></i>Nuevo
          </button>
        </div>
    </div>
</div>


<table
        data-toggle="table"
        id="table"
        data-toolbar="#toolbar"
        data-height="460"
        data-url="{% url 'lista-persona' %}"
        data-search="true"
        data-row-style="rowStyle"
        data-side-pagination="server"
        data-pagination="true"
        data-page-list="[1, 2, 3, 4, 5]"
        data-search="true">
        <thead>
            <tr>
                <th data-field="nombre"  data-sortable="true">Nombre</th>
                <th data-field="paterno"  data-sortable="true">Apellido Paterno</th>
                <th data-field="materno"  data-sortable="true">Apellido Maderno</th>
                <th data-field="sexo" data-sortable="true">Sexo</th>
                <th data-field="lugar" >Lugar de Nacimiento</th>
                <th data-field="action" data-formatter="actionFormatter" data-events="actionEvents">Action</th>
            </tr>
        </thead>

    </tbody>
</table>

    {% include "modalFormulario.html" with idmodal='idPersonaModal' idformulario='idPersonaForm' urlAccionform='/persona/formulario/' %}
{% endblock %}

{% block js_maestro %}

    <script>
        var formulario = $("#idPersonaForm");
        function rowStyle(row, index) {

            var classes = ['active'];
            if (index % 2 == 0) {
                return {
                    classes: classes[0]
                };
            }
            return {};
        }

        function actionFormatter(value, row, index) {
            return [
                '<a class="edit ml10" href="javascript:void(0)" title="Edit" data-toggle="modal" data-target="#idpersonaModal">',
                '<i class="fa fa-edit"></i>',
                '</a>',
                '<a class="remove ml10" href="javascript:void(0)" title="Remove">',
                '<i class="fa fa-remove"></i>',
                '</a>'
            ].join('');
        }

        window.actionEvents = {
            'click .edit': function (e, value, row, index) {
                alert('You click edit icon, row: ' + JSON.stringify(row));
                console.log(value, row, index);
            },
            'click .remove': function (e, value, row, index) {
                alert('You click remove icon, row: ' + JSON.stringify(row));
                console.log(value, row, index);
            }
        };
         $("#idPersonaModal").on('shown.bs.modal', function () {
            $(this).find('h4').text("Nueva Persona")
            $(this).find(".modal-body").load("{% url 'persona-formulario'%}");
        });

        $("#idNuevaPersona").on('click', function () {

            $("#idPersonaModal").modal('show');

        });
        $("#idBotonModal").on('click', function () {
             $.post("{% url 'persona-formulario' %}", formulario.serialize())
                 .done(function( data ) {
                    $("#idPersonaModal").find(".modal-body").html(data)
                 });
            {#formulario.submit();#}
        });

    </script>


{% endblock %}
